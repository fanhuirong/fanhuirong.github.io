---
date: 2016-07-29 10:54
title: js异步编程笔记

---

#读书笔记---js异步编程
```js
for (var i = 1; i <= 3; i++) {
    setTimeout(function(){  
        console.log(i); 
    }, 0);
};
```
这是一个前端面试常考题目啊，问大家输出是神马
本年反应，输出的是 1 2 3，然而
结果是，输出了三遍4。
究其原因，就是js异步的缘故啦。
1. i的作用于不是循环内部，而是包含循环的最里面的函数
2. 循环结束后，一直递增，直到不满足i<=3
3. js事件处理器在线程空闲前不会运行
也就是说，在for循环运行完之前，setTimeout的回调不会触发，for循环执行第一次，放一个setTimeout回调函数到事件队列里，直到for循环结束，此时for身后有三个函数需要执行，把他们都执行了就可以了，而在他们执行的时候，i已经变成了4，所以输出了三次4。
####线程阻塞
![](~/11-21-33.jpg)
在while循环结束之前，setTimeout的回调不会触发，所以至少1秒后才会触发。
####队列 事件循环
事件循环，就像代码从一个循环中不断取出而运行一样
###异步函数
####I/O函数
js 实现**非阻塞式I/O**
####计时函数
setTimeout 与 setInterval 不精确，会有延时
node中想精确 用process.nextTick
浏览器端 可以用shim

JavaScript 写手如果称一个函数为“异步的”，其意思是这个函数会导致将来再运行另一个函数，后者取自于事件
队列（若后面这个函数是作为参数传递给前者的，则称其为回调函数，简称为回调）。

取用回调的函数都会将其作为自己的最后一个参数。（可惜的是，老资格的 setTimeout 和 setInterval 都是这一约定的特例。）

###